# userapi-clean-ach

#### Тестовое задание в компанию TrueConf

Задача: ```произвести рефакторинг кода```

Что было сделано:
 - так как весь сервис был написал в одном файле - *main.go*, то такой сервис сложно масштабировать, тестировать и добавлять новый функционал. Таким образом, я решил разделить приложение на слои и воспользоваться принципами *clean architecture*.
 - приложение было разделено на три слоя: слой адаптеров, слой usecase и слой репозитория. Такое разделение позволит тестировать отдельные части приложения независимо: отдельно бизнес-логику, отдельно репозиторий, отдельно обработчики. Также дает возможность заменять отдельную логику в слое без влияния на другие слои: например, вместо хранения в json можно хранить в базе данных, вместо обычного http-сервера использовать gRPC сервер или другой фреймворк.  
 - так как при работе и считыванием из файла мы пользуемся map, необходимо все операции c map(чтение из map и запись в map), оборачивать в мьютекс. (Map не потокобезопасен).
 - был написан graceful shutdown при закрытии сервера. это необходим, чтобы наш сервер корректно завершал работу. 

Как далее можно улучшить: 
 - Заменить хранение данных. Операция чтение и запись в файл является дорогой.
 - Как мне кажется можно заменить роутер, на более удобный, при этом производительность запросов не упадет.
 - Реализовывать некоторую бизнес-логику, например контролировать create или update юзера. Добавить валидацию данных.
 - Добавить документацию на каждый метод (OpenAPI)